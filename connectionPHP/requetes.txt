//Requète affichant le nom, prenom année de naissance, permière année de paticipation et nationnalité d'un coureur

select tdf_coureur.nom, prenom, annee_naissance, annee_prem, tdf_nation.nom
from tdf_coureur
join tdf_app_nation using (n_coureur)
join tdf_nation using (code_cio);


//Affiche etape et gangnant de l'etape
select code_cio_D, code_cio_A, ville_D, ville_A, distance, moyenne, cat_code, tdf_coureur.nom, tdf_coureur.prenom
from tdf_etape
join tdf_temps using(annee, n_comp) 
join tdf_coureur using(n_coureur)
where rang_arrivee=1 and annee=;


//Requète affichant le nom, prenom, et nom du sponsor d'un coureur

select tdf_coureur.nom, prenom, tdf_sponsor.nom
from tdf_coureur
join tdf_parti_coureur using(n_coureur)
join tdf_parti_equipe using(annee, n_equipe, n_sponsor)
join tdf_sponsor using(n_sponsor, n_equipe)
where annee=;


//Requète affichant le nom, prénom et type d'abandon des coureurs

select tdf_coureur.nom, prenom, libelle
from tdf_coureur
join tdf_abandon using(n_coureur)
join tdf_typeaban using (c_typeaban)
where annee=;


//Villes étapes
select ville_a as ville_étape
from tdf_etape
union
select ville_d
from tdf_etape


//Nations participantes
select tdf_nation.nom
from tdf_nation
join tdf_app_nation using(code_cio)
join tdf_abandon using(n_coureur)
join tdf_annee using(annee);



//Palmarès d'un coureur (where nom like 'nom' and prenom like 'prenom')
//nombre de participation
select count(annee) as nb_participation 
from tdf_classements_generaux;

//Année de participation et rang d'arrivée
select annee, rang_arrivee 
from tdf_classements_generaux;

//nombre d'étape gagnée
select count(n_etape) as nb_etape_gagnee
from tdf_etape
join tdf_temps using(n_etape, annee, n_comp)
join tdf_coureur using(n_coureur)
where rang_arrivee = 1;

//nombre d'étape participé
select count(n_etape) from tdf_etape
join tdf_temps using(n_etape, annee, n_comp)
join tdf_coureur using(n_coureur);

//nombre d'abandon
select count(n_coureur) as nombre_abandon from tdf_abandon
join tdf_coureur using(n_coureur)

//année abandon, numéro étape, libellé abandon
select annee, n_etape, libelle 
from tdf_abandon
join tdf_etape using(annee, n_etape, n_comp)
join tdf_typeaban using(c_typeaban)
join tdf_coureur using(n_coureur)
where nom like 'PORTE' and prenom like 'Richie' 
order by annee asc


select *
from tdf_coureur;
